# Sección 03: Eureka Server Registrando microservicios

---

## Introducción a Eureka

Es una herramienta que sirve para el registro y descubrimiento de servicios. Fue inicialmente creada por `Netflix` y
diseñada para arquitecturas de microservicios.

La principal ventaja de `Eureka Server` es que elimina la necesidad de que los microservicios conozcan de antemano las
ubicaciones de otros servicios con los que necesitan interactuar. En lugar de esto, se registran en `Eureka` y otros
servicios los consultan allí cuando los necesitan. De esta manera `Eureka` resuelve uno de los principales problemas de
las arquitecturas de microservicios: `la localización dinámica de servicios`.

Veamos un poco más a fondo sus ventajas:

- `Registro dinámico`: Cada microservicio se registra automáticamente en el servidor.
- `Balanceo de carga`: Al trabajar en conjunto con otros componentes como `Spring Cloud LoadBalancer`, permite
  distribuir las solicitudes entre las distintas instancias de un microservicio.
- `Tolerancia a fallos`: Si un servicio falla o deja de enviar `«heartbeats»` (señales de vida) al servidor,
  `Eureka Server` lo elimina del registro automáticamente, esto nos ayuda a evitar fallos en cadena.
- `Escalabilidad`: Facilita la escalabilidad horizontal, lo que a su vez permite que nuevos servicios se añadan o
  retiren sin problemas.

![01.png](assets/section-03/01.png)

## [Creando servidor de registro Eureka](https://start.spring.io/#!type=maven-project&language=java&platformVersion=3.4.4&packaging=jar&jvmVersion=21&groupId=dev.magadiflo&artifactId=discovery-server&name=discovery-server&description=Discovery%20Server&packageName=dev.magadiflo.discovery.server.app&dependencies=cloud-eureka-server)

Creamos nuestro proyecto únicamente con la dependencia de `Spring Cloud Eureka Server`.

````xml
<!--Spring Boot 3.4.4-->
<!--Spring Cloud Version 2024.0.1-->
<!--Java 21-->
<dependencies>
    <dependency>
        <groupId>org.springframework.cloud</groupId>
        <artifactId>spring-cloud-starter-netflix-eureka-server</artifactId>
    </dependency>
</dependencies>
````

Para habilitar esta aplicación como un servidor de eureka debemos agregar la anotación `@EnableEurekaServer` en la clase
principal.

````java

@EnableEurekaServer
@SpringBootApplication
public class DiscoveryServerApplication {

    public static void main(String[] args) {
        SpringApplication.run(DiscoveryServerApplication.class, args);
    }

}
````

A continuación debemos configurar el `application.yml`.

````yml
server:
  port: 8761
  error:
    include-message: always

spring:
  application:
    name: discovery-server

eureka:
  instance:
    hostname: localhost
  client:
    register-with-eureka: false
    fetch-registry: false
    service-url:
      defaultZone: http://${eureka.instance.hostname}:${server.port}/eureka/
````

Ahora, si levantamos el `discovery-server` podremos ver su dashboard en la dirección `http://localhost:8761`.

![02.png](assets/section-03/02.png)
